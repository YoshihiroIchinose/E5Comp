# Microsoft Purview Communication Compliance 用、要注意サンプル用語集 2
こちらのプロジェクトでは、Microsoft Purview の Communication Compliance を利用・検証するに当たって、不正なコミュニケーションを検出するためのサンプルの用語集を提供します。
用語は、カスタムの機密情報の定義として [XML](https://github.com/YoshihiroIchinose/E5Comp/blob/main/StockManipulationJP.xml) ファイルで用意していますので、
ダウンロードの上、PowerShell で Office 365 に取り込んで利用ください。用語集の 1 は、こちらの[ページ](https://github.com/YoshihiroIchinose/E5Comp/blob/main/CC.md) を参照ください。

## キーワード作成手法
CC では、職場にふさわしくないコミュニケーションや画像などを、事前学習済みの Trainable Classifier や、
2024 年 8 月時点でプレビュー提供中の、Azure Content Safety の機能を使った LLM ベースの検知などが段階的に実装されています。
ただし、カスタムの Trainable Classifier や、事前学習済みの Stock Manipulation の Trainable Classifer などは現時点で日本語対応していません。
そこでこのサンプルは、生成系 AI の一つである Copilot for Microsoft 365 を用いて、相場操縦・株価操作に関するメッセージ サンプルを出力し、
それらのメッセージ検知できるように、メッセージに含まれる特徴的なキーワードを抽出し Purview で利用可能な機密情報の種類の設定に落とし込んだものとなっています。
なお Purview 上の設定として、文字列での一致が可能なキーワード リストとして、ワード ブレークに依存しない検知ができるようにしており、
また汎用的にヒットしなそうなキーワードは、前後 30 文字の範囲で、補助要素となるキーワードが必須となるような検知の設定として過検知を抑制しています。
実環境の展開においては、さらなる過検知の抑制や、検知シナリオの追加など行って、適宜ブラシュアップください。

# 事前に一度実施
## PowerShellを管理権限で立ち上げて以下を実行
    Set-ExecutionPolicy -ExecutionPolicy RemoteSigned
    Install-Module -Name ExchangeOnlineManagement

# カスタムの機密情報として要注意ワードを XML で取り込み
## PowerShell より Exchange Online に接続
    Connect-IPPSSession

## ローカルの XML ファイルをアップロード
    New-DlpSensitiveInformationTypeRulePackage -FileData (Get-Content -Path "C:\Users\imiki\Desktop\Work\Comp\StockManipulationJP.xml" -Encoding Byte)

## 一度アップロード済みで新しいバージョンの定義に更新の場合
    Set-DlpSensitiveInformationTypeRulePackage -FileData (Get-Content -Path "C:\Users\imiki\Desktop\Work\Comp\StockManipulationJP.xml" -Encoding Byte)

# Communication Complianceのポリシーを設定
取り込んだ以下のカスタムの機密情報を含むコミュニケーションを検出するよう Communication Compliance のポリシーを設定のこと。

M1.相場操縦

# 定義済みの NG ワード
## M1.相場操縦
相場操縦・株価操作を示唆するメッセージを検知するサンプルです。
### パターン 1. 相場操縦単独NGワード
#### 主要素となるキーワード (信頼度 高)
"仮装売買","馴合売買","高値形成,"安値形成","価格操作","インサイダー情報","見せ玉","自己売買","相場を操作","株価を操作","株価を動か","価格を操作","価格を動か","売り崩し","見せ板"

### パターン 2. 相場操縦NG動作
#### 主要素となるキーワード
"大量に買","大量に売","大量に取引","少しずつ売","少しずつ売","少しずつ取引","集中的に買","集中的に売","集中的に取引","集中して買","集中して売","集中して取引","注文を集中","集中的に取引","集中して取引","惑わせ","連続して買","連続して売","注文を取り消","注文を取消","キャンセル",
"終値","始値","買い上が","誘導","逆張","売買を繰","買い集","売り集","取引を集中"
#### 主要素の前後 30 文字以内に必須の補助要素 (主要素とセットで初めて信頼度 高で検知) 
"上げる","下げる","上げよ","下げよ","減らす","増やす","高値形成","安値形成","低下させる","固定","安定","相場を動か","相場を上げ","相場を下げ",""株価を上げ","株価を下げ","価格を上げ","価格を下げ","取引を有利に","取引が不利に","高くする",
"安くする","高くし","安くし","特定の時間","特定の価格","注目を集め","見て","先回","引き込"

### パターン 3. 相場操縦虚偽情報動作
#### 主要素となるキーワード
"誘導し","誤解を与え","混乱さ","抑圧し","圧力を","流し","取引を行","情報を使","タイミングを調整","取引量を増","取引量を減","に活用し","実際の取引","実際の売買"

#### 主要素の前後 30 文字以内に必須の補助要素 (主要素とセットで初めて信頼度 高で検知) 
"偽の","異なる","インサイダー","内部","極秘","秘密","内密","内緒","非公開","未公開","告発","虚偽","競合","ニュースを","SNSで","決算発表前","気づかない","気付かない","市場に","競合他社"


